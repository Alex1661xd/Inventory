ğŸ›‹ï¸ Sistema de GestiÃ³n de MueblerÃ­as (SaaS Multi-Tenant)
1. PropÃ³sito de la AplicaciÃ³n
El sistema estÃ¡ diseÃ±ado para digitalizar y optimizar la operaciÃ³n de una mueblerÃ­a con mÃºltiples almacenes, resolviendo tres problemas crÃ­ticos:

Eficiencia en Ventas: Elimina la necesidad de que los vendedores memoricen precios. Mediante el uso de cÃ³digos de barras, pueden consultar precios y existencias en tiempo real.

Control Administrativo (Flujo de Caja): Permite al administrador (dueÃ±o) supervisar ventas, calcular ganancias netas (Precio Venta - Precio Costo), ver el rendimiento de cada vendedor y gestionar el inventario entre mÃºltiples bodegas.

Presencia Digital: Genera automÃ¡ticamente un catÃ¡logo web actualizado para los clientes finales, sincronizado directamente con las ventas realizadas en fÃ­sico.

Modelo de Negocio (SaaS): La arquitectura permite que el software sea vendido a otras mueblerÃ­as, manteniendo los datos de cada cliente totalmente aislados y seguros.

2. Estructura de Datos (Entidades Principales)
El corazÃ³n del sistema es una base de datos relacional optimizada para el aislamiento de datos (Multi-tenancy):

Tenant (Inquilino): Representa a cada mueblerÃ­a cliente. Todo dato en el sistema pertenece a un TenantId.

User: Gestiona el acceso con roles (ADMIN para dueÃ±os, SELLER para vendedores).

Product: Almacena informaciÃ³n del mueble, imÃ¡genes, precios de costo y venta, y su cÃ³digo de barras Ãºnico.

Warehouse & Stock: Permite rastrear cuÃ¡ntas unidades de un producto hay en cada ubicaciÃ³n fÃ­sica (Bodega A, Local B, etc.).

Invoice & InvoiceItem: Registra cada venta, el mÃ©todo de pago, el cliente y congela el precio de venta en el tiempo para reportes contables precisos.

3. Estado Actual del Backend (NestJS)
El backend ya cuenta con la infraestructura de seguridad y la base de datos sincronizada.

Estructura de Carpetas:
Plaintext
backend/src/
â”œâ”€â”€ auth/           # Registro transaccional de negocios y seguridad JWT
â”œâ”€â”€ prisma/         # ConexiÃ³n y modelos de base de datos (PostgreSQL)
â”œâ”€â”€ supabase/       # IntegraciÃ³n con el motor de identidad de Supabase
â”œâ”€â”€ common/         # Decoradores y Guards para extraer el TenantId
â”œâ”€â”€ products/       # MÃ³dulo de productos (CRUD completo + validaciones)
â”œâ”€â”€ warehouses/     # MÃ³dulo de almacenes (CRUD bÃ¡sico)
â””â”€â”€ inventory/      # MÃ³dulo de inventario (actualizaciÃ³n de stock + consultas)

Hitos Logrados:
Registro Transaccional: Al crear una cuenta, el sistema crea en un solo paso el usuario, la empresa y la primera bodega.

Seguridad SaaS: ImplementaciÃ³n de SupabaseStrategy que valida tokens y asegura que ningÃºn usuario acceda a datos de otra mueblerÃ­a.

ORM Prisma: Modelado completo de las relaciones de inventario y facturaciÃ³n.

MÃ³dulo de Products (CRUD completo):
- POST /products: Crea productos con tenantId automÃ¡tico y barcode autogenerado (MUE-XXXXXXXX) si no se proporciona.
- GET /products: Lista productos del tenant con stock total sumado de todos los almacenes.
- GET /products/:id: Detalle de producto con stock total.
- PATCH /products/:id: EdiciÃ³n parcial de producto.
- DELETE /products/:id: Borrado de producto.
- Validaciones con class-validator: longitud mÃ¡xima, precios >= 0, UUIDs, etc.

MÃ³dulo de Warehouses:
- POST /warehouses: Crea almacÃ©n con tenantId automÃ¡tico.
- GET /warehouses: Lista almacenes del tenant.
- Validaciones con class-validator.

MÃ³dulo de Inventory:
- PATCH /inventory/update-stock: Actualiza stock (sumar/restar) por producto y almacÃ©n.
  - Solo usuarios ADMIN/SUPER_ADMIN pueden modificar stock.
  - Valida que producto y almacÃ©n pertenezcan al tenant.
  - Bloquea cantidades negativas.
  - Usa transacciones para consistencia.
- GET /inventory/stock: Consulta stock con filtros opcionales por productId y warehouseId.
  - Incluye datos anidados de producto y almacÃ©n.
  - Scoping estricto por tenant.

4. Estado Actual del Frontend (Next.js 15)
El frontend utiliza las Ãºltimas tecnologÃ­as de React para ofrecer una experiencia rÃ¡pida y segura.

Estructura de Carpetas:
Plaintext
frontend/app/
â”œâ”€â”€ (admin)/        # Dashboard privado (Protegido por Server-side auth)
â”‚   â””â”€â”€ dashboard/  # Panel de control de tu papÃ¡
â”œâ”€â”€ (public)/       # Vistas para clientes y login
â”‚   â”œâ”€â”€ login/      # Acceso al sistema
â”‚   â”œâ”€â”€ register/   # Registro de nuevas mueblerÃ­as
â”‚   â””â”€â”€ [slug]/     # Ruta dinÃ¡mica para el catÃ¡logo de cada mueblerÃ­a
â””â”€â”€ utils/supabase/ # ConfiguraciÃ³n SSR para persistencia de sesiÃ³n
Hitos Logrados:
AutenticaciÃ³n SSR: El sistema verifica la sesiÃ³n en el servidor antes de renderizar la pÃ¡gina, evitando parpadeos de contenido protegido.

Route Groups: SeparaciÃ³n clara entre lo que ve el cliente final (CatÃ¡logo) y lo que ven tus papÃ¡s (AdministraciÃ³n).

UI Base: IntegraciÃ³n de Tailwind CSS y componentes listos para formularios y tablas.

5. Resumen del Flujo TecnolÃ³gico
Identidad: Gestionada por Supabase Auth.

Base de Datos: PostgreSQL alojado en Supabase, consultado vÃ­a Prisma.

LÃ³gica de Negocio: Centralizada en NestJS para garantizar que las reglas de inventario y precios se cumplan estrictamente.

Interfaz: Next.js para un catÃ¡logo SEO-friendly y un dashboard administrativo tipo aplicaciÃ³n de escritorio.